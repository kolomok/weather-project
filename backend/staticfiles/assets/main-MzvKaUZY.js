document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("city"),c=document.getElementById("temp"),a=document.getElementById("weather-icon");navigator.geolocation?navigator.geolocation.getCurrentPosition(d,r):(e.textContent="Геолокация не поддерживается",o("Prague"));function d(t){const n=t.coords.latitude,w=t.coords.longitude;fetch(`/api/weather/?lat=${n}&lon=${w}`).then(s=>s.json()).then(i).catch(()=>o("Prague"))}function r(){o("Prague")}function o(t){fetch(`/api/weather/?city=${t}`).then(n=>n.json()).then(i)}function i(t){if(!t||!t.main){e.textContent="Ошибка данных";return}e.textContent=t.name,c.textContent=`${Math.round(t.main.temp)}°C`;const n=t.weather[0].icon;a.className="wi "+u(n)}function u(t){return{"01d":"wi-day-sunny","01n":"wi-night-clear","02d":"wi-day-cloudy","02n":"wi-night-alt-cloudy","03d":"wi-cloud","03n":"wi-cloud","04d":"wi-cloudy","04n":"wi-cloudy","09d":"wi-showers","09n":"wi-showers","10d":"wi-day-rain","10n":"wi-night-alt-rain","11d":"wi-thunderstorm","11n":"wi-thunderstorm","13d":"wi-snow","13n":"wi-snow","50d":"wi-fog","50n":"wi-fog"}[t]||"wi-na"}});
