document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("city"),r=document.getElementById("temp"),e=document.createElement("i");e.classList.add("wi"),r.after(e),navigator.geolocation?navigator.geolocation.getCurrentPosition(u,a):(o.textContent="Геолокация не поддерживается",i("Prague"));function u(t){const n=t.coords.latitude,l=t.coords.longitude;fetch(`/api/weather/?lat=${n}&lon=${l}`).then(f=>f.json()).then(c).catch(()=>i("Prague"))}function a(){alert("Не удалось определить местоположение. Показана погода для Prague."),i("Prague")}function i(t){fetch(`/api/weather/?city=${t}`).then(n=>n.json()).then(c)}function c(t){if(!t||!t.weather||!t.main){o.textContent="Ошибка загрузки данных";return}o.textContent=t.name,r.textContent=`${Math.round(t.main.temp)}°C`;const n=t.weather[0].id;e.className="wi",e.classList.add(s(n))}function s(t){return t>=200&&t<300?"wi-thunderstorm":t>=300&&t<600?"wi-rain":t>=600&&t<700?"wi-snow":t===800?"wi-day-sunny":t>800?"wi-cloudy":"wi-na"}});
