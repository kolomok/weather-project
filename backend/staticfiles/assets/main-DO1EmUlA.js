document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("city"),a=document.getElementById("temp"),i=document.createElement("i");i.className="wi wi-day-sunny",a.after(i),navigator.geolocation?navigator.geolocation.getCurrentPosition(s,u):(c.textContent="Геолокация не поддерживается",o("Prague"));function s(e){const t=e.coords.latitude,n=e.coords.longitude;fetch(`/api/weather/?lat=${t}&lon=${n}`).then(l=>l.json()).then(r).catch(()=>o("Prague"))}function u(){alert("Не удалось получить местоположение, показываю погоду для Prague."),o("Prague")}function o(e){fetch(`/api/weather/?city=${e}`).then(t=>t.json()).then(r)}function r(e){if(!e||!e.weather||!e.weather[0])return;c.textContent=e.name,a.textContent=`${Math.round(e.main.temp)}°C`;const t=e.weather[0].main.toLowerCase();let n="wi wi-day-sunny";t.includes("cloud")&&(n="wi wi-cloud"),t.includes("rain")&&(n="wi wi-rain"),t.includes("snow")&&(n="wi wi-snow"),t.includes("thunder")&&(n="wi wi-thunderstorm"),(t.includes("mist")||t.includes("fog"))&&(n="wi wi-fog"),i.className=n}});
