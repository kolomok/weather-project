document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("city"),r=document.getElementById("temp"),n=document.createElement("img"),i=document.createElement("p");r.after(n),n.after(i),navigator.geolocation?navigator.geolocation.getCurrentPosition(s,u):(o.textContent="Геолокация не поддерживается",c("Prague"));function s(t){const e=t.coords.latitude,l=t.coords.longitude;fetch(`/api/weather/?lat=${e}&lon=${l}`).then(m=>m.json()).then(a).catch(()=>c("Prague"))}function u(){alert("Не удалось получить местоположение. Показываю погоду для Prague."),c("Prague")}function c(t){fetch(`/api/weather/?city=${t}`).then(e=>e.json()).then(a)}function a(t){if(!t||!t.main){o.textContent="Ошибка загрузки данных";return}o.textContent=t.name,r.textContent=`${Math.round(t.main.temp)}°C`,i.textContent=t.weather[0].description;const e=t.weather[0].icon;n.src=`https://openweathermap.org/img/wn/${e}@2x.png`,n.alt=t.weather[0].description}});
